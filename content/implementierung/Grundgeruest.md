# Implementierung
## Grundgerüst

Die Implementierung des Grundgerüstes für das Bomberman-Spiel basiert auf dem Javaframework Processing mit der Erweiterung des Simple Multi-Touch(SMT) Frameworks. Processing ist ein Framework zur Entwicklung von grafischen Anwendungen. Es kann mittels einer eigenständigen Entwicklungsumgebung oder direkt in Java verwendet werden. Das SMT Framework ermöglich zusätzlich die Verwendung von touchfähigen Monitoren.

Der Einstiegspunkt zur Implementierung einer grafischen Anwendung mit Processing ist die Klasse `PApplet`.
Die eigentliche Implementierung erfolgt in der Klasse `Field`, welche von der Klasse `PApplet` erbt. Innerhalb des `Field` müssen zwei Methoden definiert werden. Zum einen die `setup`-Methode. Sie definiert alle Rahmenbedingungen der grafischen Anwendung, wie beispielsweise die Auflösung. Processing ruft diese Methode einmalig beim Starten der Anwendung auf. Die zweite Methode ist die `draw`-Methode. `draw` wird von Processing in jedem Frame aufgerufen. Sie definiert, welche grafischen Elemente auf dem Bildschirm angezeigt werden.

Neben der `setup`-Methode wurde in der Implementierung auch der Konstruktor der Klasse verwendet, um die in der `setup`-Methode verwendeten Attribute der Klasse zur Verfügung zu stellen. Der Konstruktur ließt dazu die `properties`-Datei mit den definierten Einstellungen für das Spiel ein. Er erstellt zudem eine Hashmap mit allen in der Anwendung benötigten Grafiken, welche als Texturen für einzelne Elemente dienen, ein. Über diese Hashmap können andere Funktionen in konstanter Zeit auf die Grafiken zugreifen, ohne dass zusätzliche Dateisystemoperationen notwendig sind.

In der `setup`-Methode wird als Erstes die Auflösung der Anwendung und gleichzeitig die Rendering Engine definiert. Letztere wird auf `SMT.RENDERER` festgelegt, um das SMT-Framework benutzen zu können. Die Auflösung für die Anwendung wurde während des Entwicklungsprozesses fest definiert, für den produktiven Einsatz des Spiels lässt sie sich jedoch mittels der Varibalen `this.displayWidth` und `this.displayHeight` an die aktuelle Auflösung des Bildschirms anpassen.

Die Methode initialisiert des Weiteren das Spielfeld, ein Raster von Blöcken, auf dem sich die Spielfiguren bewegen. Der Abschnitt "Spielfeld" beschreibt die Details dazu genauer. Neben dem Spielfeld werden auch die Bereiche für die Steuerung für die Nutzer angelegt, die so genannte `UserArea`. Diese Klasse, die von der SMT-Klasse `Zone` erbt, wird für jeden Spieler angelegt. Jeder `UserArea` wird dabei direkt eine Spielfigur, eine Instanz der `Bomberman`-Klasse zugeordnet. Der Nutzer kann über die Steuerungsmöglichkeiten der `UserArea` direkt mit seiner Spielfigur interagieren.

Um die Zugänglichkeit des Spiels für vier Spieler zu ermöglichen, wurden jeweils zwei Steuerungen auf der langen Seite des Bildschirmes positioniert. Zwei Steuerungen befinden sich gespiegelt auf der gegenüberliegenden Seite des Bildschirmes.

### Spielfeld

Die Klasse `Blocks` stellt das grundlegende Spielfeld dar. Es generiert die zweidimensionale Blockaufteilung, wie sie im Paper Prototype bereits dargestellt war. Dazu verwaltet die Klasse eine Matrix aus einzelnen Elementen der Klasse `Block`. Diese Klasse ist für die Darstellung eines Blocks verantwortlich. Dazu gehört das Erstellen einer Shape durch das Processing Element `PShape` und eine bestimmte Textur für die Anzeige des Blocks. Dabei ist die Erstellung, das Rendering, von der Anzeige getrennt. Ein Rendering in jedem Frame würde sich negativ auf die Performance des gesamten Spiels auswirken. Diese Trennung von Rendering und Anzeige wird von allen Elementen benutzt. Die Größe eines Blocks berechnet sich dynamisch anhand der Displaygröße und der Dimensionen des Spielfeldes. Dadurch skaliert das Blockraster mit der Auflösung des Bildschirms. Die Textur des Blocks wird anhand seines Types bestimmt. Folgende Typen existieren: verdeckter Block, leerer Block, Block mit Gegenstand, statischer Block, Block mit Bombe.

Während des Spielstarts werden unter den verdeckten Blöcken zufällig Gegenstände verteilt. Mehr dazu im Abschnitt "Upgrades". Statische Blöcke werden nur in jeder zweiten Zeile und Spalte des Spielfeldes generiert, sodass zwischen zwei statischen Blöcken mindestens ein verdeckter oder leerer Block existiert.

Wie im Paper Prototype bewegt sich der Bomberman innerhalb des Blockrasters. Dabei ist es ihm nur möglich, sich auf leeren Blöcken zu bewegen. Verdeckte und statische Blöcke verhindern die Bewegung der Spielfigur.
Um den Bomberman beim Spielstart einen Raum zur Bewegung zu geben, wird um deren Startposition, jeweils in einer Ecke des Blockrasters, ein horizontaler und vertikaler Block ausgespart und als leerer Block dargestellt. Von diesen Blöcken aus muss sich der Spieler seinen Weg durch das Spielfeld sprengen, wobei er nur verdeckte Blöcke sprengen kann. Wird ein verdeckter Block gesprengt, wird entweder ein unter ihm versteckter Gegenstand oder ein leerer Block gerendert und angezeigt.
